<template name="restaurantSaleTableSaleInvoice">
    {{#contentFor "headerButtonLeft"}}
        {{>ionNavBackButton href="/restaurant/sale" text='ត្រលប់ទៅកាន់តុ'}}
    {{/contentFor}}
    {{#contentFor "headerButtonRight"}}
        <button class="button button-clear" data-ion-modal="#">{{> ionIcon icon="calculator"}}គិតលុយ</button>
    {{/contentFor}}
    {{#contentFor "headerTitle"}}
        <h1 class="title">{{{invoiceNumber}}}</h1>
    {{/contentFor}}
    {{#ionView}}
        {{#ionContent class="padding contact-detail"}}
            {{#with saleInvoice}}
                {{> tableHeader}}
            {{/with}}
            <div class="list card">
                <div class="item item-body">
                    <div class="row">
                        <div class="col col-20">
                            <b>បរិយាយ</b>
                        </div>
                        <div class="col col-15">
                            <b>តម្លៃ</b>
                        </div>
                        <div class="col col-15">
                            <b>ចំនួន</b>
                        </div>
                        <div class="col col-15">
                            <b>បញ្ចុះតម្លៃ</b>
                        </div>
                        <div class="col col-20">
                            <b>សរុប</b>
                        </div>
                        <div class="col col-5" align="right">
                            <b>ជម្រើស</b>
                        </div>
                        <div class="col col-5">

                        </div>
                    </div>
                </div>
                {{#each saleDetails}}
                    {{> saleDetail}}
                {{/each}}
            </div>
            {{> saleInvoiceTotal}}
        {{/ionContent}}
    {{/ionView}}
    {{> _sale_invoice_tabs}}
</template>

<template name="saleDetail">
    <div class="item item-body">
        <div class="row">
            <div class="col col-20">
                <h4>{{_product._category.name}}{{_product.name}}</h4>
                {{#if note}}
                    <p>
                        {{note}}
                    </p>
                {{/if}}
            </div>
            <div class="col col-15">
                <h4>{{price}}</h4>
                <p>
                    {{details.notes}}
                </p>
            </div>
            <div class="col col-15">
                <h4>{{quantity}}</h4>
                <p>
                    {{details.notes}}
                </p>
            </div>
            <div class="col col-15">
                <h4>{{discount}}</h4>
                <p>
                    {{details.notes}}
                </p>
            </div>
            <div class="col col-20">
                <h4>{{amount}}</h4>
                <p>
                    {{details.notes}}
                </p>
            </div>
            <div class="col col-5">
                <a class="tab-item positive" href="{{goToSaleDetailEdit}}" data-action="fake">
                    <i class="icon ion-ios-compose-outline"></i>
                    <b>កែប្រែ</b>
                </a>
            </div>
            <div class="col col-5">
                <a class="tab-item assertive remove-sale-detail" href="#" data-action="fake">
                    <i class="icon ion-trash-a"></i>
                    <b>លុបចោល</b>
                </a>
            </div>
        </div>
    </div>
    <!-- <div class="item tabs tabs-secondary tabs-icon-left" style="background: #ddd;">
      <a class="tab-item" href="#" data-action="fake">
        <i class="icon ion-ios-compose-outline"></i>
        <b>កែប្រែ</b>
      </a>
      <a class="tab-item" href="#" data-action="fake">
        <i class="icon ion-trash-a"></i>
        <b>លុបចោល</b>
      </a>
    </div> -->
</template>
<!--  http://localhost:3000/restaurant/sale/001/table/00001/saleInvoice/160222001/-->


<template name="saleInvoiceTotal">
    <div class="col col-50 col-offset-50">
        <div class="list card">
            <div class="item item-body">
            {{#with saleInvoice}}
                <div class="row">
                    <div class="col col-10"></div>
                    <div class="col col-20">
                        Sub Total
                    </div>
                    <div class="col col-50">
                        <b>{{subTotal}} {{exchangeRate.symbol}}</b>
                    </div>
                </div>
                <div class="row">
                    <div class="col col-10">
                        <!-- <a href="#" class="assertive edit-sale" data-ion-modal="_editDiscount" data-id="{{_id}}">{{> ionIcon icon="edit"}}កែប្រែ</a> -->
                        <a href="{{goToEditDiscount}}" class="assertive edit-discount">{{> ionIcon icon="edit"}}</a>
                    </div>
                    <div class="col col-20">
                        បញ្ចុះតម្លៃ
                    </div>
                    <div class="col col-50">
                        <b>{{discount}}</b>
                    </div>
                </div>
                <div class="row">
                    <div class="col col-10"></div>
                    <div class="col col-20">
                        Total
                    </div>
                    <div class="col col-50">
                        <b>{{total}} {{exchangeRate.symbol}}</b>
                    </div>

                </div>

                    {{/with}}

                {{#each exchangeRate.rates}}
                    <div class="row">
                        <div class="col col-10"></div>
                        <div class="col col-20">
                            Total {{toCurrencyId}}
                        </div>
                        <div class="col col-50">
                            <b>{{multiply rate saleInvoice.total toCurrencyId}} {{symbol}}</b>
                        </div>
                    </div>
                {{/each}}
            </div>
        </div>
    </div>
</template>


<template name="_sale_invoice_tabs">
    {{#if isAndroid}}
        {{#ionTabs style="android" class="tabs-background-balanced tabs-color-light"}}
            {{> ionTab title="កម្ម៉ង់បន្ថែម" href=goToCheckout class="order-more" icon="ios-cart"}}
            {{> ionTab title="Sale" path="tabs.one" icon="coffee"}}
        {{/ionTabs}}
    {{else}}
        {{#ionTabs style="ios"}}
            {{> ionTab title="កម្ម៉ង់បន្ថែម" href=goToCheckout class="order-more positive" icon="ios-cart"}}
            {{> ionTab title="Sale" path="restaurant.sale" class="positive" iconOff="coffee" iconOn="coffee"}}
        {{/ionTabs}}
    {{/if}}
</template>

<template name="tableHeader">
    <div class="list card">
        <div class="item item-body">
            <div class="row">
                <div class="col col-10">
                    <!-- <a href="#" class="assertive edit-sale" data-ion-modal="_editSale" data-id="{{_id}}">{{> ionIcon icon="edit"}}កែប្រែ</a> -->
                    <a href="{{goToEditSale}}" class="assertive edit-sale">{{> ionIcon icon="edit"}}កែប្រែ</a>
                </div>
                <div class="col col-10">
                    <b>តុលេខៈ</b>
                </div>
                <div class="col col-10">
                    {{_table.name}}
                </div>
                <div class="col col-10">
                    <b>ថ្ងៃទីៈ</b>
                </div>
                <div class="col col-15">
                    {{moFormat saleDate 'YYYY-MM-DD HH:mm:ss'}}
                </div>
                <div class="col col-10">
                    <b>អតិថិជនៈ</b>
                </div>
                <div class="col col-10">
                    {{_customer.name}}
                </div>
                <div class="col col-10">
                    <b>បុគ្គលិក:</b>
                </div>
                <div class="col col-15">
                    {{_staff.profile.username}}
                </div>
            </div>
        </div>
    </div>
</template>
